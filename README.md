<!-- <div align="center"> -->

# Re-thinking Acoustic Image Enhancement

### Across Underwater Sonar and Medical Ultrasound

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/18q6odwhEs-xJtmEZ1VuEZ1b7Rp0LcqG6?usp=sharing)
[![GitHub stars](https://img.shields.io/github/stars/yangtaihong59/Rethink_Acoustic_Image_Enhancement.svg?style=social&label=Star)](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement)
[![visitors](https://visitor-badge.laobi.icu/badge?page_id=yangtaihong59.Rethink_Acoustic_Image_Enhancement)](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement)

[简体中文](README_ZH.md) | **English**

<!-- </div> -->

---

## Project Description

This project is the open-source code repository of the paper, containing the denoising method KDLAE, acoustic image quality assessment ASDQE, sample data, and environment dependencies. This document is a quick start guide and navigation.

We provide the training dataset generated by PIAIS.

<figure>
        <img src="https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement/releases/download/gif/SFLS.gif" alt ="Audio Art" >
        <figcaption>
            Datasets Download: <a href="https://www.kaggle.com/datasets/taihongyang59/quantitative-simulated-forward-looking-sonar/data">[SFLS-Q]</a>
        </figcaption>
</figure>

#### FLS Sample Video

[![Demo Video 1](https://img.youtube.com/vi/CkXvV9udJZE/0.jpg)](https://youtu.be/CkXvV9udJZE)

#### Ultrasound Sample Video

[![Demo Video 2](https://img.youtube.com/vi/uBQoOC9qfEc/0.jpg)](https://youtu.be/uBQoOC9qfEc)

The acoustic image simulation tools are still being organized.

### Directory Structure

- `requirements.txt`: Python dependency list in this directory.
- `KDLAE/`: KDLAE denoising method.
  - `KDLAE_T.ipynb`: KDLAE teacher model.
  - `KDLAE-S.ipynb`: KDLAE student model.
  - `KDLAE_model.py`: KDLAE model implementation.

- `ASDQE/`: ASDQE acoustic reference-free image quality assessment.
  - `ASDQE_model.py`: ASDQE model implementation.
  - `ASDQE_test.py`: ASDQE usage script.

- `Sample/`: Sample data or configuration.

### Environment Setup

It is recommended to use a Python virtual environment (such as venv or conda).

```bash
# 1) Navigate to the project directory
cd Rethink_Acoustic_Image_Enhancement

# 2) (Optional) Create and activate a virtual environment
python -m venv .venv && source .venv/bin/activate

# 3) Install dependencies
pip install -r requirements.txt
```

If you encounter version compatibility issues with specific deep learning frameworks (e.g., PyTorch, CUDA, etc.), please install the appropriate precompiled packages based on your CUDA version.

### Quick Start

#### Download pretrained weights from Releases

| Weight Name    | Download Link                                                                                                                                                      | Details                                                  |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
| KDLAE-T        | [KDLAE_T.pth](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement/releases/download/weight/KDLAE_T.pth)                                           | Teacher denoising model, supports adjustable denoising rate |
| KDLAE-S-FLS    | [KDLAE-S-FLS.pth](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement/releases/download/weight/KDLAE-S-FLS.pth)                                   | Forward-looking sonar distillation model, supports multi-frame input |
| KDLAE-S-US     | [KDLAE-S-US.pth](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement/releases/download/weight/KDLAE-S-US.pth)                                     | Ultrasound distillation model, supports multi-frame input     |
| ASDQE          | [ASDQE.pth](https://github.com/yangtaihong59/Rethink_Acoustic_Image_Enhancement/releases/download/weight/ASDQE.pth)                                               | Acoustic image denoising evaluation model                   |

You can also download all weights automatically using:

```bash
# 1) Download all weights
python utils/download_weights.py
```

#### 1) [KDLAE](./KDLAE/README_EN.md) Denoising

Run directly in Jupyter.
  1. Open `KDLAE/KDLAE_T.ipynb` or `KDLAE/KDLAE-S.ipynb`.
  2. In the first cell, configure the dataset path, output directory, and training/inference parameters as needed.
  3. Run all cells sequentially to complete training or inference and visualization.

#### 2) [ASDQE](./ASDQE/README_EN.md) Image Quality Assessment

`ASDQE/ASDQE_test.py` provides a test entry for reference-free quality assessment.

Please check the script header and function comments, and fill in or modify parameters such as input directory, file suffix, batch processing settings, etc., to evaluate objective metrics of original/denoised results.

## Citation

If this project is helpful for your research or product, please cite and acknowledge in your documentation or paper: TBD after paper acceptance

### License and Acknowledgments

Copyright 2025 Taihong Yang

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.


